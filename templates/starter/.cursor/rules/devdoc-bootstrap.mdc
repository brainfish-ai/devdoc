---
description: Expert documentation bootstrap using DiÃ¡taxis framework and audience-driven planning
globs: ["**/README.md", "**/package.json", "**/src/**", "**/lib/**"]
---

# Expert Documentation Bootstrap

When bootstrapping documentation, follow the **Documentation Planning Pyramid**:

```
STRATEGY (WHY)  â†’  AUDIENCE (WHO)  â†’  IA (WHAT)  â†’  APPROVAL  â†’  CONTENT (HOW)
```

## Phase 1: Strategy (WHY & WHO)

### Step 1: Check Existing Context

**Detect codebase:**
- Look for: `package.json`, `src/`, `lib/`, `app/`, `*.py`, `*.ts`, `*.go`

**If NO codebase:** "No codebase detected. Creating docs-only project." â†’ Skip to Step 2

**If codebase exists, check:**
```bash
git rev-parse HEAD  # Current commit
```

**If `.devdoc/code-graph.json` exists:**
- Compare `git.commitHash` vs current HEAD
- **Same commit** â†’ Skip scanning, go to Step 2
- **Different** â†’ Ask: "1. Full rescan  2. Incremental  3. Skip"

**If `.devdoc/context.json` exists:** Read and use existing preferences.

### Step 2: Define Goals & Audience

**Don't scan yet. Ask strategic questions first:**

#### Question 1: Documentation Purpose
```
What is the primary goal of this documentation?

1. **Enable team productivity** - Help internal developers work faster
2. **Onboard new developers** - Get new team members up to speed  
3. **Support API consumers** - Help external devs integrate your API
4. **Guide product users** - Help end users accomplish tasks
5. **Inform stakeholders** - Communicate architecture and decisions
```

#### Question 2: Primary Audience
```
Who is your PRIMARY audience?

1. **Internal Developer** - Engineers on your team
   â†’ Needs: Code flow, architecture, debugging, contribution guides
   
2. **External Developer** - API consumers, SDK users
   â†’ Needs: Quick start, authentication, code examples, reference
   
3. **Product User** - End users of your product
   â†’ Needs: Tutorials, feature guides, troubleshooting
   
4. **Content Author** - Technical writers, doc contributors
   â†’ Needs: MDX syntax, structure guidelines, publishing workflow
```

#### Question 3: Documentation Domain
```
What type of documentation?

1. **API Docs** - REST/GraphQL API reference (Voice: Professional, code-focused)
2. **Product Docs** - Feature guides for end users (Voice: Friendly, approachable)
3. **Internal Docs** - Team setup, architecture (Voice: Technical, direct)
```

#### Question 4: API Type (if API Docs)
```
What type of API?

1. **OpenAPI/REST** - I have an OpenAPI/Swagger spec
2. **GraphQL** - I have a GraphQL schema
3. **Both** - REST and GraphQL APIs
4. **Manual** - No spec file
```

#### Question 5: Code Examples Language
```
What language for code examples? (TypeScript, Python, curl, etc.)
```

---

## Phase 2: Information Architecture (WHAT)

### Step 3: Import API Specs (if applicable)

**OpenAPI:** Search for `openapi.json`, `swagger.json`, `**/openapi.*`
**GraphQL:** Search for `schema.graphql`, `schema.gql`, `**/*.graphql`

1. Copy spec to `api-reference/`
2. Validate format
3. Extract metadata (endpoints, auth, types)

### Step 4: Build Code Graph (Optional)

**Skip if:** No codebase, user chose skip, or docs-only project.

**If scanning, create `.devdoc/code-graph.json`:**

```json
{
  "$schema": "https://devdoc.sh/schemas/code-graph.json",
  "version": "1.0",
  "generatedAt": "[timestamp]",
  "git": {
    "commitHash": "[full hash]",
    "commitShort": "[7-char]",
    "branch": "[branch]",
    "isDirty": false
  },
  "project": {
    "name": "[name]",
    "language": "[lang]",
    "framework": "[framework]"
  },
  "modules": [
    {
      "name": "auth",
      "path": "src/auth/",
      "exports": [
        {
          "name": "login",
          "type": "function",
          "signature": "login(email: string, password: string): Promise<AuthToken>",
          "params": [...],
          "returns": { "type": "Promise<AuthToken>" }
        }
      ],
      "docPriority": "high"
    }
  ],
  "types": [...],
  "examples": [...],
  "errors": [...]
}
```

### Step 5: Plan Content Using DiÃ¡taxis Framework

**Classify every page by content type:**

| Type | Purpose | When to Use | Examples |
|------|---------|-------------|----------|
| **Tutorial** | Learning-oriented | First-time experience | "Build Your First Doc Site" |
| **How-To** | Task-oriented | Accomplish specific goals | "Add Custom Domain", "Configure Theme" |
| **Reference** | Information-oriented | Look up facts | Component props, CLI flags, Config schema |
| **Explanation** | Understanding-oriented | Deeper comprehension | "How MDX Processing Works", Architecture |

### Step 6: Plan Structure Based on Domain

#### API Docs
```
docs/
â”œâ”€â”€ index.mdx              # [explanation] Overview
â”œâ”€â”€ quickstart.mdx         # [tutorial] 5-min getting started
â”œâ”€â”€ authentication.mdx     # [how-to] Auth setup
â”œâ”€â”€ guides/
â”‚   â”œâ”€â”€ overview.mdx       # [explanation] Core concepts
â”‚   â””â”€â”€ {use-cases}.mdx    # [how-to] Common use cases
â”œâ”€â”€ api-reference/
â”‚   â”œâ”€â”€ openapi.json       # Imported spec
â”‚   â”œâ”€â”€ introduction.mdx   # [explanation]
â”‚   â””â”€â”€ errors.mdx         # [reference]
â””â”€â”€ sdks/                  # [reference]
```

#### Product Docs
```
docs/
â”œâ”€â”€ index.mdx              # [explanation]
â”œâ”€â”€ getting-started/
â”‚   â”œâ”€â”€ quickstart.mdx     # [tutorial]
â”‚   â””â”€â”€ key-concepts.mdx   # [explanation]
â”œâ”€â”€ features/
â”‚   â””â”€â”€ {feature}.mdx      # [how-to]
â”œâ”€â”€ tutorials/
â”‚   â””â”€â”€ {tutorial}.mdx     # [tutorial]
â””â”€â”€ troubleshooting/       # [how-to]
```

#### Internal Docs
```
docs/
â”œâ”€â”€ index.mdx              # [explanation]
â”œâ”€â”€ getting-started/
â”‚   â”œâ”€â”€ setup.mdx          # [how-to]
â”‚   â””â”€â”€ prerequisites.mdx  # [reference]
â”œâ”€â”€ architecture/
â”‚   â”œâ”€â”€ overview.mdx       # [explanation]
â”‚   â”œâ”€â”€ data-flow.mdx      # [explanation]
â”‚   â””â”€â”€ decisions/         # [explanation] ADRs
â”œâ”€â”€ development/
â”‚   â”œâ”€â”€ workflow.mdx       # [how-to]
â”‚   â””â”€â”€ debugging.mdx      # [how-to]
â””â”€â”€ contributing.mdx       # [how-to]
```

---

## Phase 3: Approval (REQUIRED)

### Step 7: Present IA for User Approval

**IMPORTANT: Always get user approval before generating documentation.**

Present the **complete Information Architecture** covering:
1. **Navigation Structure** - Tabs, groups, page ordering (sidebar view)
2. **File Structure** - Actual files to be created
3. **Content Summary** - DiÃ¡taxis breakdown
4. **Gaps Analysis** - Suggested missing docs

```
ğŸ“‹ PROPOSED DOCUMENTATION ARCHITECTURE

Based on your preferences:
  - Goal: [selected goal]
  - Audience: [primary audience]  
  - Domain: [api/product/internal]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              NAVIGATION STRUCTURE
        (How docs appear in the sidebar)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‘ TAB: Guides
â”œâ”€â”€ ğŸ“ Getting Started
â”‚   â”œâ”€â”€ Introduction           # index.mdx [explanation]
â”‚   â”œâ”€â”€ Quickstart             # quickstart.mdx [tutorial]
â”‚   â””â”€â”€ Authentication         # authentication.mdx [how-to]
â”‚
â””â”€â”€ ğŸ“ Core Concepts
    â””â”€â”€ Overview               # guides/overview.mdx [explanation]

ğŸ“‘ TAB: API Reference (OpenAPI)
â””â”€â”€ [Auto-generated from openapi.json]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                FILE STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

docs/
â”œâ”€â”€ index.mdx
â”œâ”€â”€ quickstart.mdx
â”œâ”€â”€ authentication.mdx
â”œâ”€â”€ guides/
â”‚   â””â”€â”€ overview.mdx
â””â”€â”€ api-reference/
    â””â”€â”€ openapi.json

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
               CONTENT SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š Tutorials: 1 page
ğŸ“ How-To Guides: 1 page
ğŸ“– Reference: 0 pages (auto from spec)
ğŸ’¡ Explanations: 2 pages

Total: 4 pages to generate

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                GAPS ANALYSIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  No troubleshooting guide
âš ï¸  No changelog

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Does this architecture look complete?

1. âœ… **Approve** - Generate with this structure
2. âœï¸  **Modify** - Change pages or navigation
3. â• **Add suggested** - Add missing docs
4. âŒ **Restart** - Reconsider goals/audience
```

**If user chooses "Modify":**
- Ask: Add/remove pages? Change navigation? Rename? Reorder?
- Update structure and present again

**If user chooses "Add suggested":**
- Add suggested docs to plan
- Present updated structure for approval

**If user chooses "Restart":**
- Go back to Step 2

**If user chooses "Approve":**
- Proceed to Step 8

**What IA approval covers:**

| Aspect | Description |
|--------|-------------|
| **Navigation** | Tabs, groups, page ordering |
| **Files** | File paths and folders |
| **Content Types** | DiÃ¡taxis classification |
| **Gaps** | Suggested missing docs |
| **Scope** | Total page count |

---

## Phase 4: Content (HOW)

### Step 8: Save Context (After Approval)

Create `.devdoc/context.json`:
```json
{
  "strategy": {
    "goal": "[selected goal]",
    "audience": {
      "primary": "[audience type]",
      "needs": ["need1", "need2"]
    }
  },
  "preferences": {
    "docType": "[api/product/internal]",
    "apiType": "[openapi/graphql/both/manual]",
    "codeLanguage": "[language]"
  },
  "product": {
    "name": "[name]",
    "description": "[desc]"
  },
  "api": {
    "style": "[REST/GraphQL]",
    "specPath": "[path if imported]"
  },
  "contentPlan": {
    "approved": true,
    "approvedAt": "[timestamp]",
    "pages": [
      { "path": "index.mdx", "type": "explanation", "priority": "high", "status": "planned" },
      { "path": "quickstart.mdx", "type": "tutorial", "priority": "high", "status": "planned" }
    ]
  }
}
```

### Step 9: Generate Using Writing Guidelines

**Only proceed after user has approved the IA structure in Step 7.**

**Expert Writing Standards:**

1. **Second Person** - "You can configure..." not "Users can configure..."
2. **Active Voice** - "Run the command" not "The command should be run"
3. **Task-Oriented Headings** - "How to add a custom domain" not "Custom domains"
4. **Include Examples** - Every concept needs a code example
5. **Progressive Disclosure** - Basic â†’ Advanced ordering

**Page Templates by Content Type:**

#### Tutorial
```mdx
---
title: Build [Something] with [Technology]
description: A complete tutorial to [achieve outcome]
contentType: tutorial
---

## What You'll Build

[End result + estimated time]

## Prerequisites

## Steps

<Steps>
  <Step title="Step 1">Content</Step>
</Steps>

## Next Steps
```

#### How-To Guide
```mdx
---
title: How to [Achieve Specific Goal]
description: Learn how to [specific outcome]
contentType: how-to
---

## Overview

[2-3 sentences: What, Who, Why]

## Steps

<Steps>
  <Step title="[Action verb] [object]">Content</Step>
</Steps>

## Example

## Next Steps
```

#### Reference
```mdx
---
title: [Component/API] Reference
description: Complete reference for [topic]
contentType: reference
---

## Overview

| Property | Type | Description | Default |
|----------|------|-------------|---------|

## Examples

## Related
```

#### Explanation
```mdx
---
title: Understanding [Concept]
description: Deep dive into [topic]
contentType: explanation
---

## Overview

[Why this matters]

## How It Works

[Conceptual explanation with diagrams]

## Key Concepts

## Related
```

### Step 10: Update docs.json

**OpenAPI:**
```json
{
  "docType": "api",
  "navigation": {
    "tabs": [
      { "tab": "Guides", "groups": [...] },
      { "tab": "API Reference", "type": "openapi", "spec": "api-reference/openapi.json" }
    ]
  }
}
```

**GraphQL:**
```json
{
  "navigation": {
    "tabs": [
      { "tab": "Guides", "groups": [...] },
      { "tab": "GraphQL API", "type": "graphql", "schema": "api-reference/schema.graphql" }
    ]
  }
}
```

### Step 11: Summary

```
âœ… Documentation Generated!

Strategy:
  - Goal: [selected goal]
  - Audience: [primary audience]
  - Domain: [api/product/internal]

Content Plan (DiÃ¡taxis):
  - Tutorials: X pages
  - How-To Guides: X pages
  - Reference: X pages
  - Explanations: X pages

Files created:
  - .devdoc/context.json (strategy)
  - .devdoc/code-graph.json (code analysis)
  - docs.json
  - [list of mdx files with content types]

Next: Run `devdoc dev` to preview, then "whisk theme" for branding.
```

---

## Key Principles

| Principle | Description |
|-----------|-------------|
| **Strategy first** | Define goals and audience before structure |
| **Audience-driven** | Match content to user needs |
| **DiÃ¡taxis types** | Classify every page by content type |
| **IA approval required** | Always get user approval before generating content |
| **Build code graph** | Extract all signatures for accuracy |
| **Real code only** | Use exact signatures, never fabricate |
| **Expert writing** | Second person, active voice, task-oriented |
| **Mark unknowns** | Add TODO for sections needing review |

## Quality Checklist

- [ ] Title is clear and specific
- [ ] Introduction explains the "why"  
- [ ] Content type matches page purpose
- [ ] Code examples are complete and tested
- [ ] Links to related docs included
- [ ] Follows writing guidelines
- [ ] Progressive disclosure (basic â†’ advanced)
