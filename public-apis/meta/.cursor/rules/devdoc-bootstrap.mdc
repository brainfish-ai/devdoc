---
description: Expert documentation bootstrap using DiÃ¡taxis framework and audience-driven planning
globs: ["**/README.md", "**/package.json", "**/src/**", "**/lib/**"]
---

# Expert Documentation Bootstrap

When bootstrapping documentation, follow the **Documentation Planning Pyramid**:

```
OVERVIEW  â†’  STRATEGY  â†’  IA  â†’  APPROVAL  â†’  CONTENT
```

## Phase 1: Strategy (WHY & WHO)

### Step 1: Project Overview (Quick Scan)

**Get a quick understanding using git:**

```bash
git ls-files                                    # List all files
git ls-files | cut -d'/' -f1 | sort -u         # Top-level folders
git ls-files | grep -E "(README|package\.json|openapi|swagger)"  # Key files
```

**Generate brief summary (<100 words):**

```
ğŸ“ PROJECT OVERVIEW

Name: [from package.json/README]
Type: [API/Library/CLI/Web App]
Language: [TypeScript/Python/Go]
Framework: [Next.js/Express/FastAPI]

Structure:
â”œâ”€â”€ src/     â†’ Source code
â”œâ”€â”€ lib/     â†’ Library
â”œâ”€â”€ api/     â†’ API routes
â””â”€â”€ tests/   â†’ Tests

Key Files: README.md, package.json, openapi.json

Summary: [One sentence describing what this project does]
```

**If NO codebase:** "No codebase detected. Creating docs-only project."

**If `.devdoc/context.json` exists:** Read and use existing preferences.

### Step 2: Define Goals & Audience

**Ask strategic questions:**

#### Question 1: Documentation Purpose
```
What is the primary goal?

1. **Enable team productivity** - Internal developers
2. **Onboard new developers** - New team members
3. **Support API consumers** - External developers
4. **Guide product users** - End users
5. **Inform stakeholders** - Architecture/decisions
```

#### Question 2: Audience & Roles
```
Does your product have multiple user roles?

A) **Single audience** - All users have same access
B) **Multiple roles** - Different users see different features
   (e.g., Admin/Editor/Viewer, different permission levels)
```

**If Single (A):**
```
1. **Internal Developer** â†’ Code flow, architecture
2. **External Developer** â†’ Quick start, auth, examples
3. **Product User** â†’ Tutorials, feature guides
4. **Content Author** â†’ MDX syntax, structure
```

**If Multi-role (B):**
```
Define your roles:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Role            â”‚ Features/Permissions       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Admin           â”‚ All features, user mgmt    â”‚
â”‚ Editor          â”‚ Create/edit content        â”‚
â”‚ Viewer          â”‚ Read-only access           â”‚
â”‚ Developer       â”‚ API access, webhooks       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

How to organize role-specific content?
1. **Separate sections** - admin/, users/, developers/
2. **Inline badges** - <RoleBadge roles={["admin"]}>
3. **Hybrid** - Both approaches
```

#### Question 3: Documentation Domain
```
1. **API Docs** - Voice: Professional, code-focused
2. **Product Docs** - Voice: Friendly, approachable
3. **Internal Docs** - Voice: Technical, direct
```

#### Question 4: API Type (if API Docs)
```
1. **OpenAPI/REST** - Have spec file
2. **GraphQL** - Have schema
3. **Both** - REST and GraphQL
4. **Manual** - No spec file
```

#### Question 5: Code Examples Language
```
TypeScript, Python, curl, Go, etc.
```

---

## Phase 2: Information Architecture (WHAT)

### Step 3: Import API Specs (if applicable)

**OpenAPI:** Search for `openapi.json`, `swagger.json`
**GraphQL:** Search for `schema.graphql`

1. Copy spec to `api-reference/`
2. Validate format
3. Extract metadata

### Step 4: Plan Content Using DiÃ¡taxis Framework

| Type | Purpose | Examples |
|------|---------|----------|
| **Tutorial** | Learning-oriented | "Build Your First..." |
| **How-To** | Task-oriented | "Add Custom Domain" |
| **Reference** | Information lookup | CLI flags, Config |
| **Explanation** | Understanding | Architecture, Concepts |

**Structure by Domain:**

#### API Docs
```
docs/
â”œâ”€â”€ index.mdx           # [explanation]
â”œâ”€â”€ quickstart.mdx      # [tutorial]
â”œâ”€â”€ authentication.mdx  # [how-to]
â”œâ”€â”€ guides/             # [explanation/how-to]
â””â”€â”€ api-reference/      # [reference]
```

#### Product Docs
```
docs/
â”œâ”€â”€ index.mdx           # [explanation]
â”œâ”€â”€ getting-started/    # [tutorial]
â”œâ”€â”€ features/           # [how-to]
â””â”€â”€ troubleshooting/    # [how-to]
```

#### Internal Docs
```
docs/
â”œâ”€â”€ index.mdx           # [explanation]
â”œâ”€â”€ getting-started/    # [how-to]
â”œâ”€â”€ architecture/       # [explanation]
â”œâ”€â”€ development/        # [how-to]
â””â”€â”€ contributing.mdx    # [how-to]
```

---

## Phase 3: Approval (REQUIRED)

### Step 5: Present IA for User Approval

**IMPORTANT: Always get user approval before generating.**

```
ğŸ“‹ PROPOSED DOCUMENTATION ARCHITECTURE

Based on your preferences:
  - Goal: [selected goal]
  - Audience: [primary audience]  
  - Domain: [api/product/internal]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              NAVIGATION STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‘ TAB: Guides
â”œâ”€â”€ ğŸ“ Getting Started
â”‚   â”œâ”€â”€ Introduction           # index.mdx [explanation]
â”‚   â”œâ”€â”€ Quickstart             # quickstart.mdx [tutorial]
â”‚   â””â”€â”€ Authentication         # authentication.mdx [how-to]
â””â”€â”€ ğŸ“ Core Concepts
    â””â”€â”€ Overview               # guides/overview.mdx [explanation]

ğŸ“‘ TAB: API Reference (OpenAPI)
â””â”€â”€ [Auto-generated from openapi.json]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                FILE STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

docs/
â”œâ”€â”€ index.mdx
â”œâ”€â”€ quickstart.mdx
â”œâ”€â”€ authentication.mdx
â””â”€â”€ api-reference/openapi.json

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
               CONTENT SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š Tutorials: 1 page
ğŸ“ How-To Guides: 1 page
ğŸ’¡ Explanations: 2 pages

Total: 4 pages

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                GAPS ANALYSIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  No troubleshooting guide
âš ï¸  No changelog

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Does this look complete?

1. âœ… **Approve** - Generate with this structure
2. âœï¸  **Modify** - Change pages/navigation
3. â• **Add suggested** - Add missing docs
4. âŒ **Restart** - Reconsider goals
```

---

## Phase 4: Content (HOW)

### Step 6: Save Context (After Approval)

Create `.devdoc/context.json`:
```json
{
  "strategy": {
    "goal": "[goal]",
    "audience": { "primary": "[type]", "needs": [...] }
  },
  "preferences": {
    "docType": "[api/product/internal]",
    "codeLanguage": "[language]"
  },
  "contentPlan": {
    "approved": true,
    "pages": [
      { "path": "index.mdx", "type": "explanation" },
      { "path": "quickstart.mdx", "type": "tutorial" }
    ]
  }
}
```

### Step 7: Generate WITH File Search (CRITICAL)

**Only after user approval in Step 5.**

**For EACH page in the content plan:**

```
1. SEARCH for relevant files
   git ls-files | grep -iE "(auth|login|token)"
   rg -l "authentication" --type ts

2. READ the files found
   - Extract real signatures, types, examples
   - Note the source files

3. DETECT feature flags & duplicates
   rg -l "featureFlag|isEnabled|FF_" --type ts
   rg "export.*(login|authenticate)" --type ts -l
   
   âš ï¸ FEATURE FLAG: newAuthFlow
      OLD vs NEW implementation
      â†’ Ask user which to document
   
   ğŸ”„ DUPLICATE: authenticate() in v2/
      â†’ Ask user how to handle

4. ASSESS if enough info exists
   âœ… Sufficient â†’ Draft content
   âš ï¸ Partial â†’ Draft with TODOs
   âŒ Insufficient â†’ Flag and offer options

5. REVIEW DRAFT with user (MANDATORY)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTENT REVIEW: authentication.mdx
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   
   [Show full draft content]
   
   NOTICES:
   âš ï¸ Feature flag: newAuthFlow
   ğŸ”„ Duplicate: authenticate() in v2/
   
   OPTIONS:
   1. âœ… Approve - Create file
   2. âœï¸ Edit - Make changes
   3. ğŸ”„ Switch version - Use flagged version
   4. â• Add duplicate - Include related
   5. â­ï¸ Skip - Don't create
   
6. WRITE only after user approves
```

**Expert Writing Standards:**
1. **Search before write** - ALWAYS find source files first
2. **No hallucination** - Only real data from files
3. **Review with user** - Show draft before creating
4. **Flag feature flags** - Ask which version
5. **Flag duplicates** - Let user choose
6. **Second Person** - "You can configure..."
7. **Include REAL Examples** - From tests/examples
8. **Use Mermaid Diagrams** - For architecture, flows, sequences

**Mermaid Diagram Requirements:**
| Content | Diagram Type |
|---------|--------------|
| Architecture | `flowchart TB` |
| Data flow | `flowchart LR` |
| API calls | `sequenceDiagram` |
| State machine | `stateDiagram-v2` |
| Data models | `erDiagram` |

Example:
```mermaid
sequenceDiagram
    User->>API: Request
    API->>Service: Process
    Service-->>API: Response
    API-->>User: Result
```

### Step 8: Create docs.json and theme.json

**CRITICAL: Read schema files before creating config files.**

```
ğŸ“‹ SCHEMA REFERENCES (Read before writing)

1. schemas/docs.schema.json â†’ docs.json structure
2. schemas/theme.schema.json â†’ theme.json structure
```

**Review config with user before writing:**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CONFIG REVIEW: docs.json
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "$schema": "https://devdoc.sh/docs.json",
  "name": "[Product Name]",
  "docType": "[api|product|internal]",
  "navigation": {
    "tabs": [
      { "tab": "Guides", "type": "docs", "groups": [...] },
      { "tab": "API Reference", "type": "openapi" }
    ]
  }
}

Validated against: schemas/docs.schema.json âœ“

OPTIONS:
1. âœ… Approve
2. âœï¸ Edit
3. âŒ Cancel
```

**Quick Reference:**
- Tab types: `docs`, `openapi`, `graphql`, `changelog`
- Icons: `rocket-launch`, `book-open`, `code`, `gear`, `terminal`, `star`
- Colors: indigo (#6366f1), blue (#3b82f6), green (#10b981)

### Step 9: Summary

```
âœ… Documentation Generated!

Strategy:
  - Goal: [goal]
  - Audience: [audience]
  - Domain: [domain]

Content (DiÃ¡taxis):
  - Tutorials: X pages
  - How-To: X pages
  - Reference: X pages
  - Explanations: X pages

Files created:
  - .devdoc/context.json
  - docs.json
  - [mdx files]

Next: `devdoc dev` to preview
```

---

## Key Principles

| Principle | Description |
|-----------|-------------|
| **Project overview first** | Quick git scan to understand structure |
| **Strategy first** | Goals and audience before structure |
| **Audience-driven** | Match content to user needs |
| **Support multi-role** | Handle products with multiple user roles |
| **DiÃ¡taxis types** | Classify every page |
| **IA approval required** | User confirms before generating |
| **Search before generate** | ALWAYS search/read files before each page |
| **No hallucination** | Only use real data from source files |
| **Review before write** | ALWAYS show draft for user approval |
| **Flag feature flags** | Detect conditional features, ask which version |
| **Flag duplicates** | Find similar features, let user choose |
| **Flag unclear sections** | Offer auto-correct IA if info not found |
| **Expert writing** | 2nd person, active voice |
| **Mark unknowns** | Add TODO for review |

## Quality Checklist

- [ ] Title is clear
- [ ] Intro explains "why"
- [ ] Content type matches purpose
- [ ] Code examples included
- [ ] Links to related docs
- [ ] Progressive disclosure
